<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notas e Desempenho</title>
    <style>
        /* ----------------------------------------------------------------
        * CSS GERAL (Mantendo o estilo)
        * ---------------------------------------------------------------- */
        :root {
            --primary-color: #004a99; /* Azul UNIP */
            --secondary-color: #ff9900; /* Laranja de destaque */
            --text-color: #333;
            --light-bg: #f4f7f9;
            --white: #ffffff;
            --success-color: #28a745;
            --alert-color: #dc3545;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            background-color: var(--light-bg);
            color: var(--text-color);
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: auto;
            overflow: hidden;
        }

        /* --- Header e Navega√ß√£o --- */
        .main-header {
            background: var(--primary-color);
            color: var(--white);
            padding: 15px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .main-header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .main-header h1 {
            font-size: 1.5em;
            margin: 0;
        }

        .user-info {
            margin-right: 20px;
            font-weight: bold;
            color: var(--white);
        }
        
        /* --- Bot√µes --- */
        .btn {
            display: inline-block;
            padding: 8px 15px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn.primary {
            background-color: var(--secondary-color);
            color: var(--white);
        }
        .btn.primary:hover {
            background-color: #e68a00;
        }

        .btn.secondary {
            background-color: #ccc;
            color: var(--text-color);
        }

        /* --- Estilos Comuns --- */
        .content-area {
            padding: 30px 0;
        }

        .content-area h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        .filters {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 15px;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .filters select {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            flex-grow: 1;
        }
        
        /* --- Tabela de Notas (Aluno) --- */
        .notas-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--white);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden; 
        }

        .notas-table th, .notas-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .notas-table th {
            background-color: var(--primary-color);
            color: var(--white);
            font-weight: bold;
        }
        .notas-table tr:hover { background-color: #f9f9f9; }

        .status-aprovado { color: var(--success-color); font-weight: bold; }
        .status-recuperacao { color: var(--secondary-color); font-weight: bold; }
        .status-reprovado { color: var(--alert-color); font-weight: bold; }
        .no-data { text-align: center; padding: 50px; background-color: #f0f0f0; border: 1px solid #ccc; color: #666; border-radius: 8px; font-size: 1.2em; }

        /* --- Formul√°rio de Lan√ßamento (Professor) --- */
        .lancamento-form-container {
            background: var(--white);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .lancamento-form-container .input-group {
            margin-bottom: 15px;
        }
        .lancamento-form-container label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .lancamento-form-container input[type="number"],
        .lancamento-form-container select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        .form-row .input-group {
            flex: 1;
        }

        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 15px 0;
            background: #333;
            color: var(--light-bg);
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <h1 id="page-title">Notas e Desempenho üíØ</h1>
            <nav>
                <span class="user-info" id="user-info-text">Consulta Acad√™mica</span>
                <a href="dashboard.html" class="btn secondary" id="btn-voltar">Voltar ao Dashboard</a>
            </nav>
        </div>
    </header>

    <div class="container content-area">
        <h2 id="section-title">Seu Hist√≥rico de Desempenho</h2>
        
        <div id="main-content">
            </div>
    </div>

    <footer>
        <p>Acompanhe seu desempenho com agilidade.</p>
    </footer>
    
    <script>
        // --- Dados Simples ---
        const disciplinasPorCurso = {
            "ADS": ["Programa√ß√£o Orientada a Objetos", "Banco de Dados", "An√°lise e Projeto de Sistemas"],
            "Redes": ["Arquitetura de Redes", "Redes sem Fio"],
        };

        const alunosPorDisciplina = {
            "Programa√ß√£o Orientada a Objetos": ["Aluno A (RA: 101)", "Aluno B (RA: 102)", "Aluno C (RA: 103)"],
            "An√°lise e Projeto de Sistemas": ["Aluno D (RA: 104)", "Aluno E (RA: 105)"],
        };
        
        const atividadesPorDisciplina = {
            "Programa√ß√£o Orientada a Objetos": ["Trabalho Pr√°tico (Sprint)", "Avalia√ß√£o Regimental (AR)"],
            "An√°lise e Projeto de Sistemas": ["PIM I - An√°lise de Requisitos", "Avalia√ß√£o Regimental (AR)"],
        };

        // Dados simulados de Notas do Aluno Logado (vis√£o do Aluno)
        const notasSimuladasAluno = {
            "An√°lise e Projeto de Sistemas": [
                { nome: "PIM I - An√°lise de Requisitos", nota: 8.5, peso: 40, status: "Aprovado" },
                { nome: "Avalia√ß√£o Regimental (AR)", nota: 7.0, peso: 60, status: "Aprovado" },
            ],
            "Metodologia Cient√≠fica": [
                { nome: "Artigo de Revis√£o", nota: 4.0, peso: 100, status: "Reprovado" },
            ]
        };

        // --- Fun√ß√µes de Ajuda ---
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // --- Configura√ß√£o Comum: Carregar Disciplinas ---
        function carregarDisciplinas(cursoId, disciplinaId, callback = null) {
            const cursoSelect = document.getElementById(cursoId);
            const disciplinaSelect = document.getElementById(disciplinaId);
            const selectedCurso = cursoSelect.value;

            disciplinaSelect.innerHTML = '<option value="" disabled selected>Selecione a Disciplina</option>';

            if (selectedCurso) {
                disciplinaSelect.disabled = false;
                const disciplinas = disciplinasPorCurso[selectedCurso] || [];
                disciplinas.forEach(disciplina => {
                    const option = document.createElement('option');
                    option.value = disciplina;
                    option.textContent = disciplina;
                    disciplinaSelect.appendChild(option);
                });
            } else {
                disciplinaSelect.disabled = true;
            }
            if (callback) callback(); // Executa o callback ap√≥s carregar
        }

        // --- Modo ALUNO ---
        function renderAlunoView() {
            document.getElementById('user-info-text').textContent = 'Bem-vindo(a), Aluno PIM!';
            document.getElementById('section-title').textContent = 'Seu Hist√≥rico de Desempenho';
            
            document.getElementById('main-content').innerHTML = `
                <div class="filters">
                    <select id="select-curso-aluno">
                        <option value="" disabled selected>Selecione o Curso Superior</option>
                        <option value="ADS">An√°lise e Desenvolvimento de Sistemas (ADS)</option>
                        <option value="Redes">Redes de Computadores</option>
                        <option value="SI">Sistemas de Informa√ß√£o</option>
                        <option value="CC">Ci√™ncia da Computa√ß√£o</option>
                    </select>
                    
                    <select id="select-disciplina-aluno" disabled>
                        <option value="" disabled selected>Selecione a Disciplina</option>
                    </select>
                </div>
                
                <div id="lista-notas-aluno">
                    <p class="no-data">
                        Por favor, selecione um **Curso** e uma **Disciplina** para visualizar as notas.
                    </p>
                </div>
            `;
            
            document.getElementById('select-curso-aluno').addEventListener('change', () => carregarDisciplinas('select-curso-aluno', 'select-disciplina-aluno', exibirNotasAluno));
            document.getElementById('select-disciplina-aluno').addEventListener('change', exibirNotasAluno);
        }

        function exibirNotasAluno() {
            const disciplinaSelect = document.getElementById('select-disciplina-aluno');
            const listaNotasDiv = document.getElementById('lista-notas-aluno');
            const selectedDisciplina = disciplinaSelect.value;
            
            listaNotasDiv.innerHTML = ''; 

            if (!selectedDisciplina) {
                 listaNotasDiv.innerHTML = `<p class="no-data">Selecione uma **Disciplina** para visualizar suas notas.</p>`;
                return;
            }

            const notas = notasSimuladasAluno[selectedDisciplina];
            
            if (!notas || notas.length === 0) {
                 listaNotasDiv.innerHTML = `<p class="no-data">Nenhuma nota lan√ßada ainda para a disciplina **${selectedDisciplina}**.</p>`;
                return;
            }

            let tabelaHTML = `<table class="notas-table"><thead><tr><th>Atividade / Avalia√ß√£o</th><th>Nota (0-10)</th><th>Peso (%)</th><th>Situa√ß√£o</th></tr></thead><tbody>`;
            let notaTotalPonderada = 0;
            let pesoTotal = 0;

            // ... (c√°lculo e renderiza√ß√£o da tabela, como no c√≥digo anterior) ...
            notas.forEach(item => {
                notaTotalPonderada += item.nota * (item.peso / 100);
                pesoTotal += item.peso;
                
                let statusClass = '';
                if (item.status === 'Aprovado') {
                    statusClass = 'status-aprovado';
                } else if (item.status === 'Recupera√ß√£o') {
                    statusClass = 'status-recuperacao';
                } else if (item.status === 'Reprovado') {
                    statusClass = 'status-reprovado';
                }

                tabelaHTML += `<tr><td>${item.nome}</td><td>${item.nota.toFixed(1)}</td><td>${item.peso}%</td><td class="${statusClass}">${item.status}</td></tr>`;
            });

            const mediaFinal = notaTotalPonderada; 
            let statusFinal = "Pendente";
            let mediaClass = '';
            
            if (mediaFinal >= 6.0 && pesoTotal > 0) {
                statusFinal = "Aprovado!";
                mediaClass = 'status-aprovado';
            } else if (mediaFinal >= 4.0 && mediaFinal < 6.0 && pesoTotal > 0) {
                statusFinal = "Recupera√ß√£o (Exame)";
                mediaClass = 'status-recuperacao';
            } else if (mediaFinal < 4.0 && pesoTotal > 0) {
                statusFinal = "Reprovado";
                mediaClass = 'status-reprovado';
            }
            
            tabelaHTML += `
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" style="text-align: right; font-weight: bold; border-top: 2px solid #ccc;">M√©dia Parcial (Total Ponderado):</td>
                            <td style="font-weight: bold; border-top: 2px solid #ccc; font-size: 1.1em;" class="${mediaClass}">${mediaFinal.toFixed(2)} (${statusFinal})</td>
                        </tr>
                    </tfoot>
                </table>
            `;

            listaNotasDiv.innerHTML = tabelaHTML;
        }


        // --- Modo PROFESSOR ---
        function renderProfessorView() {
            document.getElementById('page-title').textContent = 'Lan√ßamento de Notas üìù';
            document.getElementById('user-info-text').textContent = 'Professor(a) - Lan√ßamento de Notas';
            document.getElementById('section-title').textContent = 'Selecionar Turma e Atividade';
            
            document.getElementById('main-content').innerHTML = `
                <div class="lancamento-form-container">
                    <form id="lancamento-notas-form">
                        <div class="form-row">
                            <div class="input-group">
                                <label for="select-curso-prof">Curso Superior:</label>
                                <select id="select-curso-prof" required>
                                    <option value="" disabled selected>Selecione o Curso Superior</option>
                                    <option value="ADS">An√°lise e Desenvolvimento de Sistemas (ADS)</option>
                                    <option value="Redes">Redes de Computadores</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="select-disciplina-prof">Disciplina:</label>
                                <select id="select-disciplina-prof" disabled required>
                                    <option value="" disabled selected>Selecione a Disciplina</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="input-group">
                                <label for="select-atividade">Atividade/Avalia√ß√£o:</label>
                                <select id="select-atividade" disabled required>
                                    <option value="" disabled selected>Selecione a Atividade</option>
                                </select>
                            </div>
                        </div>

                        <hr style="margin: 30px 0;">

                        <h3>Lan√ßamento Individual</h3>

                        <div class="form-row">
                            <div class="input-group">
                                <label for="select-aluno">Aluno (RA):</label>
                                <select id="select-aluno" disabled required>
                                    <option value="" disabled selected>Selecione o Aluno</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="input-nota">Nota (0 a 10):</label>
                                <input type="number" id="input-nota" name="nota" min="0" max="10" step="0.1" disabled required placeholder="Ex: 8.5">
                            </div>
                        </div>

                        <div class="input-group">
                            <label for="dicaIA">Dica de Uso de IA / Sustentabilidade: üí°</label>
                            <input type="text" id="dicaIA" name="dicaIA" value="Ex: Use algoritmos de IA para identificar padr√µes de notas baixas e sugerir material de refor√ßo." disabled>
                        </div>

                        <button type="submit" class="btn primary btn-submit" disabled id="btn-lancar">Lan√ßar Nota</button>
                    </form>
                </div>
            `;
            
            // Adicionar Listeners do Professor
            document.getElementById('select-curso-prof').addEventListener('change', () => carregarDisciplinas('select-curso-prof', 'select-disciplina-prof', carregarAlunosEAtividades));
            document.getElementById('select-disciplina-prof').addEventListener('change', carregarAlunosEAtividades);
            document.getElementById('lancamento-notas-form').addEventListener('submit', simularLancamento);
        }
        
        // Fun√ß√µes espec√≠ficas do Professor
        function carregarAlunosEAtividades() {
            const disciplinaSelect = document.getElementById('select-disciplina-prof');
            const alunoSelect = document.getElementById('select-aluno');
            const atividadeSelect = document.getElementById('select-atividade');
            const selectedDisciplina = disciplinaSelect.value;

            // Limpa e Desabilita
            alunoSelect.innerHTML = atividadeSelect.innerHTML = '<option value="" disabled selected>Selecione...</option>';
            alunoSelect.disabled = atividadeSelect.disabled = true;
            document.getElementById('input-nota').disabled = true;
            document.getElementById('btn-lancar').disabled = true;
            document.getElementById('dicaIA').disabled = true;

            if (selectedDisciplina) {
                // Carregar Alunos
                const alunos = alunosPorDisciplina[selectedDisciplina] || [];
                alunos.forEach(aluno => {
                    const option = document.createElement('option');
                    option.value = aluno;
                    option.textContent = aluno;
                    alunoSelect.appendChild(option);
                });
                alunoSelect.disabled = false;

                // Carregar Atividades
                const atividades = atividadesPorDisciplina[selectedDisciplina] || [];
                atividades.forEach(ativ => {
                    const option = document.createElement('option');
                    option.value = ativ;
                    option.textContent = ativ;
                    atividadeSelect.appendChild(option);
                });
                atividadeSelect.disabled = false;
                
                // Ativa os campos de nota e bot√£o quando Aluno e Atividade forem selecionados
                alunoSelect.addEventListener('change', ativarCamposLancamento);
                atividadeSelect.addEventListener('change', ativarCamposLancamento);
            }
        }
        
        function ativarCamposLancamento() {
            const alunoSelecionado = document.getElementById('select-aluno').value;
            const atividadeSelecionada = document.getElementById('select-atividade').value;
            const inputNota = document.getElementById('input-nota');
            const btnLancar = document.getElementById('btn-lancar');
            const dicaIA = document.getElementById('dicaIA');
            
            if (alunoSelecionado && atividadeSelecionada) {
                inputNota.disabled = false;
                btnLancar.disabled = false;
                dicaIA.disabled = false;
            } else {
                inputNota.disabled = true;
                btnLancar.disabled = true;
                dicaIA.disabled = true;
            }
        }
        
        function simularLancamento(event) {
            event.preventDefault(); 
            const aluno = document.getElementById('select-aluno').value;
            const disciplina = document.getElementById('select-disciplina-prof').value;
            const atividade = document.getElementById('select-atividade').value;
            const nota = document.getElementById('input-nota').value;

            alert(`Lan√ßamento Confirmado!
            Aluno: ${aluno}
            Disciplina: ${disciplina}
            Atividade: ${atividade}
            Nota Atribu√≠da: ${nota}`);

            // Opcional: Redireciona para o dashboard ap√≥s o envio
            // window.location.href = 'dashboard.html?perfil=professor'; 
        }

        // --- Inicializa√ß√£o Principal ---
        document.addEventListener('DOMContentLoaded', function() {
            const perfil = getUrlParameter('perfil');
            const btnVoltar = document.getElementById('btn-voltar');
            
            // Configura o link de voltar
            if (perfil === 'professor') {
                btnVoltar.href = 'dashboard.html?perfil=professor';
                renderProfessorView();
            } else {
                btnVoltar.href = 'dashboard.html?perfil=aluno';
                renderAlunoView();
            }
        });
    </script>
</body>
</html>